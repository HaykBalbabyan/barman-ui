(()=>{"use strict";var t={276:(t,e,s)=>{s.d(e,{Bl:()=>m,hj:()=>a,bG:()=>p,Rm:()=>f,B:()=>d,Lp:()=>u,yu:()=>c,Nd:()=>h});class r{#t;#e;constructor(t){this.#t={url:t.url,method:(t.method??"get").toUpperCase(),data:t.data??{},success:t.success??(()=>{}),error:t.error??(()=>{}),beforeSend:t.beforeSend??(()=>{}),contentType:t.contentType??""},this.#e="",this.#t.data&&(this.#e=this.#s(this.#t.data),this.#t.contentType=this.#t.contentType?this.#t.contentType:"application/x-www-form-urlencoded")}#s(t,e=""){const s=[];for(const r in t)if(t.hasOwnProperty(r)){const n=e?`${e}[${r}]`:r;if("object"!=typeof t[r]||Array.isArray(t[r]))Array.isArray(t[r])?t[r].forEach(((t,e)=>{if("object"!=typeof t||Array.isArray(t))s.push(`${n}[]=${encodeURIComponent(t)}`);else{const r=this.#s(t,`${n}[${e}]`);s.push(r)}})):s.push(`${n}=${encodeURIComponent(t[r])}`);else{const e=this.#s(t[r],n);s.push(e)}}return s.join("&")}async send(){this.#t.beforeSend();let t=null;const e=new XMLHttpRequest;this.#t.url+="POST"!==this.#t.method&&this.#e?"?"+this.#e:"",e.open(this.#t.method,this.#t.url,!0,"",""),this.#t.contentType&&e.setRequestHeader("Content-Type",this.#t.contentType),e.send(this.#e);const s=this;e.onreadystatechange=await(function(){if(4===this.readyState){t={statusCode:e.status,statusText:e.statusText};try{t.response=JSON.parse(e.responseText)}catch(s){t.response=e.responseText}200===this.status?s.#t.success(t.response,t):s.#t.error(t.response,t)}})}}var n=s(834);const o={templates:{urlpath:"https://ball.infinitycloud.ru/public",dirpath:"./public"}},i=JSON.parse('{"controller":{"name":"Dashboard","path":"/controller","template":"/controller.html","title":"Controller"},"dashboard":{"name":"Dashboard","path":"/","template":"/dashboard.html","title":"Dashboard"},"not-found":{"name":"Not found","template":"/not-found.html","title":"404 Not found"}}');async function a(t){return await new r(t).send()}async function c(t){return await new n.Z(t)}const l=new class{#r={};#n={};#o;constructor(){this.#o=document.querySelector("#app")}async getContent(t,e=null){const s=this;this.#r[t]?await this.#i(this.#r[t],t,e):await a({url:t,method:"get",async success(r){s.#r[t]=r,await s.#i(r,t,e)}})}#i(t,e,s=null){const r=this,n=(new DOMParser).parseFromString(t,"text/html"),o=n.querySelectorAll("script");if(this.#a(e),this.#n[e])for(const t in this.#n[e])this.#c(this.#n[e][t],t,e);else{this.#n[e]={};const t=n.querySelectorAll("style");for(const s of t){if(s.getAttribute("src"))a({url:s.getAttribute("src"),success(t){r.#n[e][s.getAttribute("src")]={code:t},r.#c(r.#n[e][s.getAttribute("src")],s.getAttribute("src"),e)}});else if(s.textContent){const t=(""+Math.random()).replace("0.","");r.#n[e][t]={code:s.textContent},r.#c(r.#n[e][t],t,e)}s.remove()}}s?s.innerHTML=n.body.innerHTML:this.#o.innerHTML=n.body.innerHTML,Array.from(o).map((t=>{t.src&&t.src.includes(".js")?c({srcs:[t.src]}):c({scripts:[t.textContent]})}))}#c(t,e,s){const r=document.createElement("style"),n="style-id-"+(""+Math.random()).replace("0.","");r.id=n,r.textContent=t.code,this.#n[s][e].id=n,document.head.append(r)}#a(t){for(const e in this.#n)if(e!==t&&Object.keys(this.#n[e]).length)for(const t of Object.values(this.#n[e]))document.querySelector("#"+t.id).remove()}};async function u(t,e){await l.getContent(t,e)}const h=new class{#l={};#u=null;referer={};events={onLoad:t=>{},onChange:(t,e)=>{}};constructor(){this.#h()}async#h(){this.referer=null,await this.update(),this.#d(),this.events.onLoad(this.#u)}#d(){window.addEventListener("popstate",(t=>{this.update(),this.#p(),setTimeout((()=>{"function"==typeof this.events.onChange&&this.events.onChange(t.state,this.referer)}),1)})),document.addEventListener("click",(t=>{const e=t.target;if(e.matches("a[router]")||e.closest("a[router]")){const s=e.matches("a[router]")?e:e.closest("a[router]");if(!s.href)return;t.preventDefault(),this.go(s.href)}}))}#p(){const t=this.getHistoryLastId();this.referer={path:window.location.pathname,title:document.title,name:null,routeName:""},t&&(this.referer.path=this.#l[t]?.route?.path||this.referer.path,this.referer.title=this.#l[t]?.route?.title||this.referer.title,this.referer.route=this.#l[t]?.route||null,this.referer.routeName=this.#l[t]?.routeName||"")}#f(t=null,e=!1){const s=t||window.location.href;if(t&&"object"==typeof i[t])return e?i[t]:t;for(const t in i){const r=i[t],n=this.parseUrl(window.location.origin+r.path,s);if(n.match)return i[t].variables=n.variables,e?i[t]:t}return"object"==typeof i["not-found"]?e?i["not-found"]:"not-found":null}getCurrent(){return this.#u}async update(){const t=this.#f();if(t){const e=i[t];this.#u=e,await u(o.templates.urlpath+e.template),document.title=t?e.title:""}}go(t,e=!1){if(window.location.href===t&&!e)return;const s=this.#f(t);if(s||!s&&e){const e={id:this.getHistoryLastId()+1},r=i[s]||{};if(s)e.page=r.name,e.routeName=s,e.route=r;else{if(!this.isURL(t))throw new Error("Route error: Route can't be force changed because "+t+" is not right url");e.page="No name",r.routeName="",e.route=null}this.#p(),window.history.pushState(e,s?r.title:e.name,t),this.#m(e),this.update(),setTimeout((()=>{"function"==typeof this.events.onChange&&this.events.onChange(e,this.referer)}),1)}}getHistoryLastId(){const t=Object.keys(this.#l);return t.length?+t[t.length-1]:0}#m(t){const e=this.#l;e[this.getHistoryLastId()+1]=t,this.#l=e}isURL(t){return new RegExp("^(https?:\\/\\/)?((([a-zA-Z\\d]([a-zA-Z\\d-]{0,61}[a-zA-Z\\d])?)\\.)+[a-zA-Z]{2,6}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-zA-Z\\d%@_.~+&:]*)*(\\?[;&a-zA-Z\\d%@_.,~+&:=-]*)?(\\#[-a-zA-Z\\d_]*)?$","i").test(t)}parseUrl(t,e){const s=t.replace(/\{[^\}]+\}/g,"([^/]+)"),r=new RegExp(`^${s}$`),n=e.match(r);if(n){const e=t.match(/\{[^\}]+\}/g),s={};return e&&e.forEach(((t,e)=>{const r=t.replace(/[{}]/g,"");s[r]=n[e+1]})),{variables:s,match:!0}}return{variables:{},match:!1}}};function d(t,e,s,r={}){if("function"!=typeof s||"string"!=typeof t||"string"!=typeof e&&e!==document&&e!==window)return;(t=t.toLowerCase()).includes(",")&&(t=t.replace(/\s+/g,"").split(","));const n="string"==typeof e?document:e;if(Array.isArray(t))for(const e of t)n.removeEventListener(e,o,r),n.addEventListener(e,o,r);else n.removeEventListener(t,o,r),n.addEventListener(t,o,r);function o(t){if(e!==document&&e!==window){if(t.target.matches(e)||t.target.closest(e)){const r=t.target.matches(e)?t.target:t.target.closest(e);s(t,r)}}else{const r=e===document?document:window;s(t,r)}}}function p(t){return document.querySelector(t)}function f(t){return document.querySelectorAll(t)}class m{config={};constructor(){this.config=o}}},834:(t,e,s)=>{s.d(e,{Z:()=>n});var r=s(276);class n{srcs;scripts;constructor(t){this.srcs=t?.srcs||[],this.scripts=t?.scripts||[],this.#y()}async#y(){if(this.srcs)for(const t of this.srcs)await this.#w(t);if(this.scripts)for(const t of this.scripts)await eval(t)}async#w(t){await(0,r.hj)({url:t,success(t){eval(t)}})}}}},e={};function s(r){var n=e[r];if(void 0!==n)return n.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,s),o.exports}s.d=(t,e)=>{for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var r={},n;n=s(276),new n.Bl,new class{constructor(){this.#g(),this.#b()}#g(){n.Nd.events.onLoad=t=>{setTimeout((()=>{const e=document.querySelector("#page-loader-wrapper");e.style.opacity=0,(0,n.bG)("#rotate-error-wrapper")&&((0,n.bG)("#rotate-error-wrapper").style.display="");const s=(0,n.Rm)("#header .menu a");if(s)for(const e of s)n.Nd.parseUrl(window.location.origin+t.path,e.href).match&&e.classList.add("active");setTimeout((()=>{e.style.display="none"}),400)}),500)},(0,n.B)("contextMenu",document,(function(t){t.preventDefault()})),(0,n.B)("touchMove",document,(function(t){1!==t.scale&&t.preventDefault()}),{passive:!1});let t=0;(0,n.B)("touchEnd",document,(function(e){const s=(new Date).getTime();s-t<=300&&e.preventDefault(),t=s}),!1)}#b(){const t=this;let e=null,s=null;const r=window.matchMedia("(any-hover: none)").matches,o=r?"touchStart":"mouseDown",i=r?"touchEnd":"mouseUp";(0,n.B)(o,".controller-wrapper .control-button",(function(r,o){if(o?.dataset?.isBrake)e=null,s=null;else{const t=o?.dataset?.direction;e="forward"===t||"backward"===t?t:e,s="right"===t||"left"===t?t:s}(0,n.bG)(".temp").textContent="Directions: "+e+" "+s,t.#v(e,s)})),(0,n.B)(i,".controller-wrapper .control-button",(function(r,o){const i=o?.dataset?.direction;e="forward"===i||"backward"===i?null:e,s="right"===i||"left"===i?null:s,(0,n.bG)(".temp").textContent="Directions: "+e+" "+s,t.#v(e,s)})),r||(0,n.B)(i,".controller-wrapper",(function(r,o){o?.dataset?.isBrake||(e=null,s=null,(0,n.bG)(".temp").textContent="Directions: "+e+" "+s,t.#v(e,s))}))}#v(t,e){const s=e||t,r=s?"/move-"+s:"/brake";(0,n.hj)({url:r,success(t){}})}}})();